{% extends 'base.html.twig' %}

{% block title %}
	{{ article.title }}
{% endblock %}

{% block body %}
	<h1>Show Article</h1>

	<section class="articles rounded shadow mt-5 p-3">
		<article class="mb-2">
			<h2>{{ article.title }}</h2>
			<div class="metadata">
				ðŸ•¤ Submitted
				{{ article.createdAt|date('d/m/Y \\A\\t H:i') }}
				o'clock
				<span class="badge bg-danger">
					{{ article.category.title }}
				</span>
				<span class="badge bg-success" id="nmbr-comments" data-initial-count="{{ article.comments|length }}">
					{{ article.comments|length }}
					comments
				</span>
			</div>
			<div class="content">
				<img src="{{ (article.imageName ? vich_uploader_asset(article) : '/images/placeholder.jpg') | imagine_filter('squared_thumbnail_medium') }}" class="m-1 rounded shadow" alt="{{ article.title }}" srcset="">
				<p>{{ article.description }}</p>
			</div>
			{% if is_granted('ARTICLE_MANAGE',article ) %}
			<a href="{{ path('app_article_edit', parameters = {'id': article.id}) }}" class="btn btn-info">Edit</a>
			{% endif %}
		</article>
	</section>

	<section id="comments">
		{% for comment in article.comments %}
			<div class="comment p-2">
				<div class="row">
					<div class="text-danger">
						<b>{{ comment.user.fullname }}</b>
						<small>{{ comment.createdAt | date('d/m/Y \\A\\t H:i') }}</small>
					</div>
				</div>
				<p>{{ comment.comment }}</p>
			</div>
		{% endfor %}
	</section>
	<hr>
	<section class="mb-3">
		<div class="heading-container d-flex align-items-center">
			{% if app.user %}
				<h2 class="mr-2">Add Comment to this article
				</h2>
				<div class="spinner-border text-primary spinner-border-sm" role="status" id="reloadSpinner" style="display: none;"></div>
			</div>
			{{ form_start(form,{'attr': {'id': 'add_comment_form'}}) }}
			{{ form_widget(form) }}
			<button id="button-add-comment" class="mt-2 btn btn-success" type="submit">Add comment</button>
			{{ form_end(form) }}
			{% else %}
			<h2 class="mr-2">You can add comment to this article by logged in </h2>

		{% endif %}
	</section>
{% endblock %}
